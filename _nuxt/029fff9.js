(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{260:function(t,e,n){"use strict";n.r(e);var o=n(10),r=(n(55),n(68),n(69),n(27),n(130),n(53),n(175),n(100),n(54),n(39),n(236),n(240)),c=n.n(r),l=n(258),d=n.n(l),v=n(259),m={name:"ActivityPage",data:function(){return{activityId:null,laps:null,total:null,lapsDistances:[],lapDistance:null,showSplit:!1,splits:[]}},mounted:function(){location.search.includes("code")&&this.$store.commit("setId",this.cleanUpAuthToken(location.search)),this.token||this.getToken()},computed:{id:function(){return this.$store.state.id},token:function(){return this.$store.state.token}},methods:{cleanUpAuthToken:function(t){return t.split("&")[1].slice(5)},getToken:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"78089","39f746e84226343a4bd225bcb7403348802cbe7d",e.prev=2,e.next=5,c.a.post("https://www.strava.com/oauth/token?client_id=".concat("78089","&client_secret=").concat("39f746e84226343a4bd225bcb7403348802cbe7d","&code=").concat(t.id,"&grant_type=authorization_code"));case 5:n=e.sent,o=n.data.access_token,t.$store.commit("setToken",o),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),t.$router.push({path:"/"});case 13:case"end":return e.stop()}}),e,null,[[2,10]])})))()},getActivity:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.preventDefault(),n.next=3,c.a.get("https://www.strava.com/api/v3/activities/".concat(e.activityId,"?access_token=").concat(e.token));case 3:o=n.sent,e.laps=o.data.laps,e.lapsDistances=Array.from({length:e.laps.length},(function(t,i){return e.lapDistance}));case 6:case"end":return n.stop()}}),n)})))()},getPerKmPace:function(t){t.preventDefault(),this.showSplit=!0;for(var e=this.laps,n=this.lapsDistances,o=0,time=0,i=0,r=[];i<e.length;){var c=e[i].elapsed_time,l=Number(n[i]);if(o+l===1e3)r.push(time+c),time=0,o=0;else if(o+l<1e3)time+=c,o+=l;else{var d=1e3-o,v=c/l*d;r.push(time+v),o=l-d,time=c-v}i++}this.splits=r,this.createGraph(r)},formatTime:function(t){return d()(1e3*t)},createGraph:function(t){var e=document.getElementById("myChart").getContext("2d");new v.a(e,{type:"bar",data:{labels:Array.from({length:t.length},(function(t,i){return i+1})),datasets:[{label:"Pace",data:t,borderWidth:1}]},options:{plugins:{tooltip:{callbacks:{label:function(t){return d()(1e3*t.parsed.y)}}}}}})}}},h=n(51),component=Object(h.a)(m,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"p-8 min-h-screen bg-gray-100 sm:items-center"},[n("div",{staticClass:"w-1/2 m-auto"},[n("form",{directives:[{name:"show",rawName:"v-show",value:!t.laps,expression:"!laps"}],on:{submit:t.getActivity}},[n("div",{staticClass:"mb-6"},[n("label",{staticClass:"block text-gray-700 text-sm font-bold mb-2",attrs:{for:"activity-id"}},[t._v("Activity ID (open your activity on strava web and copy the id from the URL): ")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.activityId,expression:"activityId"}],staticClass:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",attrs:{id:"activity-id",placeholder:"12345678",type:"number"},domProps:{value:t.activityId},on:{input:function(e){e.target.composing||(t.activityId=e.target.value)}}})]),t._v(" "),n("div",{staticClass:"mb-6"},[n("label",{staticClass:"block text-gray-700 text-sm font-bold mb-2",attrs:{for:"total"}},[t._v("Lap Distance (meters, can be adjusted later): ")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.lapDistance,expression:"lapDistance"}],staticClass:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",attrs:{id:"total",placeholder:"400",type:"number"},domProps:{value:t.lapDistance},on:{input:function(e){e.target.composing||(t.lapDistance=e.target.value)}}})]),t._v(" "),n("input",{staticClass:"center bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline",attrs:{type:"submit",value:"Submit"}})]),t._v(" "),n("form",{directives:[{name:"show",rawName:"v-show",value:t.laps&&!t.showSplit,expression:"laps && !showSplit"}],on:{submit:t.getPerKmPace}},[t._l(t.laps,(function(e,o){return n("div",{key:e.id,staticClass:"mb-2 grid grid-cols-3 gap-3 justify-center items-center"},[n("label",{staticClass:"block text-gray-700 text-sm font-bold justify-self-center mb-2"},[t._v("Lap "+t._s(o+1))]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.lapsDistances[o],expression:"lapsDistances[index]"}],staticClass:"shadow appearance-none border rounded py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",attrs:{id:"lap",type:"number",placeholder:"Lap Distance"},domProps:{value:t.lapsDistances[o]},on:{input:function(e){e.target.composing||t.$set(t.lapsDistances,o,e.target.value)}}}),t._v(" "),n("span",{staticClass:"justify-self-center"},[t._v(t._s(e.elapsed_time))])])})),t._v(" "),n("input",{staticClass:"mt-4 block m-auto center bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline",attrs:{type:"submit",value:"Submit"}}),t._v(" "),n("button",{staticClass:"mt-4 block m-auto bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",on:{click:function(e){t.laps=null}}},[t._v("Back")])],2),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.showSplit,expression:"showSplit"}],staticClass:"result-container"},[t._m(0),t._v(" "),t._l(t.splits,(function(e,o){return n("div",{key:o,staticClass:"mb-2 grid grid-cols-2 gap-3 justify-center items-center"},[n("span",[t._v(t._s(o+1))]),t._v(" "),n("span",[t._v(t._s(t.formatTime(e)))])])})),t._v(" "),n("div",{staticClass:"chart-container"},[n("canvas",{attrs:{id:"myChart",width:"600",height:"400"}}),t._v(" "),n("button",{staticClass:"mt-4 block m-auto bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",on:{click:function(e){t.showSplit=!1}}},[t._v("Back")])])],2)])])}),[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mb-2 grid grid-cols-2 gap-3 justify-center items-center"},[n("span",[t._v("KM")]),t._v(" "),n("span",[t._v("Pace")])])}],!1,null,null,null);e.default=component.exports}}]);